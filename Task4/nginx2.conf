http {
    upstream logistics_backend {
        server logistics.company.com;
    }

    server {
        listen 8080;

        location /logistics/ {
            proxy_pass http://logistics_backend;

            proxy_read_timeout 3s;
            proxy_connect_timeout 3s;

            proxy_next_upstream error timeout http_502 http_503 http_504;
            proxy_next_upstream_tries 5;

            error_page 502 503 504 = @fallback;

            limit_req zone=one burst=5 nodelay;

            location @fallback {
                default_type application/json;
                add_header Content-Type application/json;
                return 503 '{"status": "service unavailable, please try again later."}';
            }
        }
    }

    limit_req_zone $binary_remote_addr zone=one:10m rate=1r/s;
}